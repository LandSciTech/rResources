<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rResources">
<title>Minimum requirements for good code • rResources</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Minimum requirements for good code">
<meta property="og:description" content="rResources">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rResources</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/good_code.html">Minimum requirements for good code</a>
    <a class="dropdown-item" href="../articles/package_development.html">R package development</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Minimum requirements for good code</h1>
            
      
      
      <div class="d-none name"><code>good_code.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<p><strong>TLDR:</strong> Use the <a href="https://frbcesab.github.io/rcompendium/" class="external-link">rcompendium</a> and <a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link">renv</a>
packages.</p>
<p>All code should be reproducible on someone else’s computer with
minimal effort. There are typically two challenges for this: managing
data and managing package versions.</p>
<div class="section level3">
<h3 id="project-structure">Project structure<a class="anchor" aria-label="anchor" href="#project-structure"></a>
</h3>
<p>Use the package <a href="https://frbcesab.github.io/rcompendium/" class="external-link"><code>rcompendium</code></a>
to create a new “compendium” for your R code, data and potentially
paper. This will create a standard folder structure that makes it easy
to remember paths across projects and set up useful strategies for
ensuring reproducibility. The package automates all the boilerplate
needed to follow good practices for reproducible research. Follow the
Getting Started and Working with a Compendium articles on the package
website to get set up. After initial set up it is easy to start a new
project with <code>rcompendium::new_compendium</code></p>
</div>
<div class="section level3">
<h3 id="managing-data">Managing data<a class="anchor" aria-label="anchor" href="#managing-data"></a>
</h3>
<p>Large data sets are typically not stored on GitHub so they need to be
shared another way such as through Google drive or OSF or similar.
Ideally they should be downloaded from here in the analysis code using
eg <a href="https://googledrive.tidyverse.org/" class="external-link">googledrive</a> or <a href="https://docs.ropensci.org/osfr/" class="external-link">osfr</a>. Either way the project
should have a standard folder structure (eg the default in <a href="https://frbcesab.github.io/rcompendium/articles/working_with_a_compendium.html" class="external-link">rcompendium</a>)
so that relative paths in the code continue to work.</p>
</div>
<div class="section level3">
<h3 id="managing-package-versions">Managing package versions<a class="anchor" aria-label="anchor" href="#managing-package-versions"></a>
</h3>
<p>For an analysis project that will eventually be shared in a static
way use <a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link">renv</a> to
track the packages used and their versions (also included in <a href="https://frbcesab.github.io/rcompendium/articles/working_with_a_compendium.html#using-renv" class="external-link">rcompendium</a>).
If you are creating a tool it should follow R package structure and have
all packages recorded in DESCRIPTION (see <a href="https://usethis.r-lib.org/reference/use_package.html" class="external-link"><code>usethis::use_package</code></a>)</p>
</div>
<div class="section level3">
<h3 id="coding-practices">Coding practices<a class="anchor" aria-label="anchor" href="#coding-practices"></a>
</h3>
<ul>
<li><p><a href="https://www.tidyverse.org/blog/2017/12/workflow-vs-script/" class="external-link">Never
use setwd().</a> Set up your project so that all the files you need are
in a folder within the project. If you need to get data that is outside
the project you could set the path at the top of the script or better
yet put it online and download it programmatically.</p></li>
<li><p>Put all sourced files, hardcoded variables and any paths that
might need to be changed at the top of the script.</p></li>
</ul>
<pre><code># at the top of the script
datPth &lt;- “path/to/data/folder”
#...
#...
# Wherever it is used
myData &lt;- read.csv(file.path(datPth, “myData.csv”))  </code></pre>
<ul>
<li><p>Don’t save your workspace. In Rstudio under Tools &gt; Global
Options &gt; General uncheck restore workspace and set save workspace to
never. Don’t use save() either. If there is an object that took awhile
to create and you need it for another script use <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code>
to save the individual objects. If it is a final result save it to a
normal file (tif, csv, shp, …) since these will be easier to
reuse.</p></li>
<li><p>Re-run code from the top frequently. If some part of the code
takes too long for this to be practical consider using <a href="https://books.ropensci.org/targets/" class="external-link">targets</a> or <a href="https://reproducible.predictiveecology.org/" class="external-link">reproducible</a>, or
if that is too complex save the results and at least re-run everything
else.</p></li>
<li><p>Avoid repetition. Use <a href="https://r4ds.had.co.nz/functions.html" class="external-link">functions</a> and <a href="https://r4ds.had.co.nz/iteration.html" class="external-link">loops or iteration
functions (eg <code>apply</code>, <code>purrr::map</code>)</a></p></li>
<li><p>Comment your code. Try to focus on the why instead of what the
code is doing. If you use clear names and functional programming the
what should be apparent. You can make sections in a large document to
structure it with:</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data #--------------------------</span></span>
<span></span>
<span><span class="co"># Prepare data #-----------------------</span></span>
<span></span>
<span><span class="co"># Run model #--------------------------</span></span></code></pre></div>
<ul>
<li>Consider using <a href="https://quarto.org/docs/get-started/" class="external-link">Quarto</a> or <a href="https://rmarkdown.rstudio.com/lesson-1.html" class="external-link">Rmarkdown</a> so that
you can write code, text, figures and tables together in one file that
you can render to html, pdf or word doc.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="style">Style<a class="anchor" aria-label="anchor" href="#style"></a>
</h2>
<p>Aspirational standard: <a href="https://style.tidyverse.org/" class="external-link uri">https://style.tidyverse.org/</a>. It is not necessary to
follow every detail exactly.</p>
<p>Key points:</p>
<ul>
<li>Pick a naming convention and stick to it. tidyverse uses snake_case
we sometimes uses camelCase pick one to stick to for each project.</li>
<li>Use meaningful names that are consistent. Eg. not <code>dat1</code>,
<code>dat2</code> but <code>bee_obs_raw</code> and
<code>bee_obs_use</code>.</li>
<li>Keep script to max 80 characters wide.
<ul>
<li>Under Tools&gt;Global Options&gt;Code&gt;Display you can add a
margin line at 80 char</li>
<li>Use ctrl-shift-/ to reflow comments to max 80 char</li>
</ul>
</li>
<li>Follow the spacing, indent, and assignment parts of the tidyverse
guide
<ul>
<li>Place spaces around all infix operators (=, +, -, &lt;-, etc.). The
same rule applies when using = in function calls. Always put a space
after a comma, and never before (just like in regular English).</li>
<li>Rstudio will mostly indent for you. Use ctrl-i to fix indenting for
a line or selection</li>
<li>Use &lt;- for assignment not =. Use the shortcut alt– to insert
&lt;- with spaces.</li>
<li>You can use ctrl-shift-A to style code but I don’t like the way it
breaks over lines so I use the <a href="https://styler.r-lib.org/" class="external-link">styler</a> RStudio Addin to style a
selection and then add line breaks manually.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Good</span></span>
<span><span class="va">average</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">feet</span> <span class="op">/</span> <span class="fl">12</span> <span class="op">+</span> <span class="va">inches</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bad</span></span>
<span><span class="va">average</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">feet</span><span class="op">/</span><span class="fl">12</span><span class="op">+</span><span class="va">inches</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sarah Endicott.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
